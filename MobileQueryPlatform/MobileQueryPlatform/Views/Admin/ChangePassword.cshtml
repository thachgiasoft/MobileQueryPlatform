<script>
    if (window.Pwd == undefined) {
        Tools.Namespace.register("window.Pwd");
    }
    if (window.Pwd.ChangePwdView == undefined) {
        window.Pwd.ChangePwdView = Backbone.View.extend({
            events: {
                "change #newPwdRpt": "pwdRpt",
                "click a":"submit"
            },
            submit: function () {
                var changePwd = Tools.serializeObject($("#changePwdView"));
                if (changePwd.newPwd != changePwd.newPwdRpt) {
                    alert("两次输入密码不一致");
                    return;
                }
                console.info(changePwd);
                $.post("/Admin/DoChangePassword",
                    changePwd,
                    function (rst) {
                        if (rst.ResultStatus != 1) {
                            alert(rst.ResultMessage);
                        }
                        else {
                            alert("修改成功");
                            $("#oldPwd").val("");
                            $("#newPwd").val("");
                            $("#newPwdRpt").val("");
                        }

                    }
                    )
            }
        });
    }
</script>
<script>
    var changePwdView;
    $(function () {
        changePwdView=new window.Pwd.ChangePwdView({
            el: "#changePwdView"
        });
    })
</script>
<div class="container">
    <form id="changePwdView" role="form" class="form-horizontal" action="/User/ChangePassword">
        <input type="hidden" name="ID" value="@ViewBag.UserID"/>
        <div class="form-group">
            <label for="oldPwd" class="col-sm-2 control-label">旧密码</label>
            <div class="col-sm-10">
                <input id="oldPwd" type="password" name="oldPwd" class="form-control" required />
            </div>

        </div>
        <div class="form-group">
            <label for="newPwd" class="col-sm-2 control-label">新密码</label>
            <div class="col-sm-10">
                <input id="newPwd" type="password" name="newPwd" class="form-control" required />
            </div>
        </div>
        <div class="form-group">
            <label for="newPwdRpt" class="col-sm-2 control-label">确认密码</label>
            <div class="col-sm-10">
                <input id="newPwdRpt" type="password" name="newPwdRpt" class="form-control" required />
            </div>
        </div>
        <div class="form-group">
            <div class="col-sm-offset-2 col-sm-10">
                <a class="btn btn-default">确定</a>
            </div>
        </div>
    </form>
</div>